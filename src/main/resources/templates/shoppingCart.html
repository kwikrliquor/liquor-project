<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org"
       xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:replace="partials::head('Shopping Cart')"></head>
<body>
<div th:replace="partials::header"></div>
<div th:replace="partials::navbar"></div>
<main role="main" class="container">

    <div sec:authorize="!isAuthenticated()">
        <h1 class="uk-text-large"> Please Login to View your Cart</h1>
    </div>

    <div sec:authorize="isAuthenticated()">
        <div tabindex="0" class="uk-child-width-1-2@s uk-child-width-1-3@m uk-grid uk-text-center" uk-scrollspy="cls: uk-animation-fade; target: > div > .uk-card; delay: 50; repeat: true">
            <div th:each="product : ${products.entrySet()}">
                <div class="uk-card uk-card-hover uk-card-body uk-margin-medium-bottom">
                    <h1 class="uk-card-title"><a th:text="${product.getKey().name}" th:href="@{'/products/' + ${product.getKey().id}}">Title</a></h1>
                    <hr class="uk-divider-icon" />
                    <p><em>Description</em></p>
                    <p th:text="${product.getKey().description}">Description</p>
                    <hr class="uk-divider-icon" />
                    <div th:inline="text" class="">Price: $[[${product.getKey().price}]] </div>
                    <div th:inline="text" class="">Quantity: [[${product.getValue()}]]</div>
                    <a th:href="@{'/shoppingCart/removeProduct/' + ${product.getKey().id}}" class="">
                        <button type="button" class="uk-button uk-button-default uk-button-small uk-border-rounded uk-margin-small-top" th:text="Remove">Remove</button>
                    </a>
                </div>
            </div>
            <div class="uk-grid uk-width uk-align-center">
                <h2 class="" th:inline="text">Total in cart: $[[${total}]]</h2>
                <br />
                <form th:action="@{'/shoppingCart/checkout'}" method="GET">
                    <script
                            src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                            data-key="pk_test_TYooMQauvdEDq54NiTphI7jx"
                            data-amount="Your total:"
                            data-name="KWIKRLIQUOR"
                            th:attr="data-description='Your total is: $' + ${total}"
                            data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
                            data-locale="auto"
                            data-zip-code="true">
                    </script>
                    <button type="button" class="uk-button uk-button-default uk-border-rounded" th:text="Checkout">Checkout</button>
                </form>
            </div>
        </div>
    </div>
</main><!-- /.container -->
<div th:replace="partials::footer"></div>
<div th:replace="partials::scripts"></div>
<script src="https://js.stripe.com/v3/"></script>

</body>
</html>